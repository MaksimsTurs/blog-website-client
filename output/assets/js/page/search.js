import{j as e,r as a,v as s,w as t,x as n,H as r,E as o,t as l}from"../react.js";import{T as c,u as i,U as m,_ as u,f as g,c as d,g as x,h as p,E as h}from"./admin.js";import{E as j,L as f,a as v,B as N}from"./home.js";import{u as T}from"./galery.js";const y={tag_list:"Wc",tag_item:"Xc"};function C({removeTag:a,tags:s}){return e.jsx("ul",{className:`${y.tag_list} flex-row-flex-start-normal-small`,children:s.map((s=>{const t=s.replace(/\-\d*/g,"");return t.trim()?e.jsx("li",{onClick:()=>a(s),className:y.tag_item,children:t},s):null}))})}const D={createTagArray:function(e){return e.split(/,/).map((e=>0===e.length?e:`${e}-${Math.round(9999*Math.random())}`))},removeTagKeys:function(e){return e.map((e=>e.trim().replace(/\-\d*/g,"")))}};function S({getTags:s,placeholder:t,value:n}){const[r,o]=a.useState(n||[]);return e.jsxs(a.Fragment,{children:[e.jsx(c,{name:"tags",onInput:e=>{const a=D.createTagArray(e.currentTarget.value);o(a),s(D.removeTagKeys(a))},placeholder:t,value:D.removeTagKeys(r).join(", ")}),e.jsx(C,{removeTag:e=>{o((a=>{const t=function(e,a){let s=[];for(let t=0;t<e.length;t++)e[t]!==a&&s.push(e[t]);return s}(a,e);return s(t),t}))},tags:r})]})}const w="R",$="S",_="T",b="U",O="V",E="W",L="Y";function z({changeSortData:a,sortData:s,sortDataName:t}){return e.jsx(c,{name:t,placeholder:`Find by ${t}...`,value:s[t],onInput:e=>a(t,e.currentTarget.value)})}const F=[{name:"Likes",icon:e.jsx(r,{size:17})},{name:"Views",icon:e.jsx(o,{size:17})},{name:"Comments",icon:e.jsx(l,{size:17})}],I=window.matchMedia("(width <= 930px)").matches;const R=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const[r,o]=a.useState({author:"",content:"",title:""}),[l,c]=a.useState(),y=i(),C=y.get("tag"),D=parseInt(y.get("page")||"0"),R=a.useRef(C?[C]:[]),k=a.useRef(null),M=!I||T(m["IS-FILTER-MODAL-OPEN"],k),{isPending:A,data:P,error:K,request:U}=u({deps:[`sort-${D}`],noCache:!0,request:async()=>await g.post(`/sort/${D}`,{...r,sortOption:l,tags:R.current},{Authorization:`Bearer ${d.getOne("PR_TOKEN")}`})}),q=(e,a)=>{o((s=>({...s,[e]:a})))};return e.jsx(a.Fragment,{children:K?e.jsx(j,{code:K.code,message:K.message}):e.jsxs("div",{style:{height:"100%"},className:"flex-row-normal-normal-medium",children:[e.jsxs("div",{style:{width:"100%",minHeight:"100%"},className:"flex-column-normal-normal-small",children:[I?e.jsx(s,{onClick:()=>{y.set({[m["IS-FILTER-MODAL-OPEN"]]:!0})},className:_}):null,A?e.jsx(x,{}):P&&P.pagesCount>1?e.jsx(p,{pagesCount:P.pagesCount}):null,A?e.jsx(f,{}):P&&0===P.posts.length?e.jsx(h,{option:{flexCenterCenter:!0,height:"FULL"},label:"Nothing found!"}):P&&P.posts.map((a=>e.jsx(v,{post:a,type:"preview"},a._id))),A?e.jsx(x,{}):P&&P.pagesCount>1?e.jsx(p,{pagesCount:P.pagesCount}):null]}),e.jsx("div",{ref:k,className:M?w:`${w} ${$}`,children:e.jsxs("div",{className:"main-content-container flex-column-normal-normal-small",children:[e.jsx("p",{className:b,children:"Sort by"}),e.jsx("div",{className:"flex-column-normal-normal-small",children:F.map((a=>e.jsxs("button",{onClick:()=>{return e=a.name,void c("descending"===l?.[e]?{[e]:"ascending"}:"ascending"===l?.[e]?{[e]:void 0}:{[e]:"descending"});var e},className:l?.[a.name]?`${O} ${E} flex-row-center-center-medium`:`${O} flex-row-center-center-medium`,children:[a.icon,e.jsx("p",{children:a.name}),"descending"===l?.[a.name]?e.jsx(t,{size:14}):"ascending"===l?.[a.name]?e.jsx(n,{size:14}):null]},a.name)))}),e.jsx(z,{changeSortData:q,sortData:r,sortDataName:"content"}),e.jsx(z,{changeSortData:q,sortData:r,sortDataName:"author"}),e.jsx(z,{changeSortData:q,sortData:r,sortDataName:"title"}),e.jsx(S,{getTags:e=>{R.current=e},placeholder:"Find by tags"}),e.jsxs("div",{className:`${L} flex-row-normal-normal-small`,children:[e.jsx(N,{onClick:()=>{0===D?U():y.set({page:0})},label:"Sort"}),e.jsx(N,{onClick:()=>{o({author:"",content:"",title:""}),c(void 0),y.set({page:0})},label:"Reset"})]})]})})]})})}},Symbol.toStringTag,{value:"Module"}));export{S as T,R as p};
