import{j as e,r as a,G as s,J as t,K as n,D as r,E as o,z as l}from"../react.js";import{T as i,u as c,U as m,_ as u,f as d,k as g,P as p,m as x,n as j,E as h,B as f}from"./admin.js";import{L as v,a as N}from"./home.js";import{A as D,a as T,u as C}from"./database.js";const _={tag_list:"be",tag_item:"ce"};function y({removeTag:a,tags:s}){return e.jsx("ul",{className:`${_.tag_list} flex-row-flex-start-normal-small`,children:s.map((s=>{const t=s.replace(/\-\d*/g,"");return t.trim()?e.jsx("li",{onClick:()=>a(s),className:_.tag_item,children:t},s):null}))})}const b={createTagArray:function(e){return e.split(/,/).map((e=>0===e.length?e:`${e}-${Math.round(9999*Math.random())}`))},removeTagKeys:function(e){return e.map((e=>e.trim().replace(/\-\d*/g,"")))}};function S({getTags:s,placeholder:t,value:n}){const[r,o]=a.useState(n||[]);return e.jsxs(a.Fragment,{children:[e.jsx(i,{name:"tags",onInput:e=>{const a=b.createTagArray(e.currentTarget.value);o(a),s(b.removeTagKeys(a))},placeholder:t,value:b.removeTagKeys(r).join(", ")}),e.jsx(y,{removeTag:e=>{o((a=>{const t=D.removeDuplicates(a,[e]);return s(t),t}))},tags:r})]})}const w="X",$="Y",k="Z",F="__",L="-_",z="a_",I="c_";function O({changeSortData:a,sortData:s,sortDataName:t}){return e.jsx(i,{name:t,placeholder:`Find by ${t}...`,value:s[t],onInput:e=>a(t,e.currentTarget.value)})}const E=[{name:"Likes",icon:e.jsx(r,{size:17})},{name:"Views",icon:e.jsx(o,{size:17})},{name:"Comments",icon:e.jsx(l,{size:17})}],M=window.matchMedia("(width <= 930px)").matches;const A=Object.freeze(Object.defineProperty({__proto__:null,default:function(){T({title:"Finden",description:"Hier kannst du posts mit gegebenen sortierung optionen finden."});const[r,o]=a.useState({author:"",content:"",title:""}),[l,i]=a.useState(),D=c(),_=D.get("tag"),y=parseInt(D.get("page")||"0"),b=a.useRef(_?[_]:[]),A=a.useRef(null),P=!M||C(m["IS-FILTER-MODAL-OPEN"],A),{isPending:R,data:K,error:q,request:H}=u({deps:[`sort-${y}`],noCache:!0,request:async()=>await d.post(`/sort/${y}`,{...r,sortOption:l,tags:b.current},g)}),U=(e,a)=>{o((s=>({...s,[e]:a})))};return e.jsx(a.Fragment,{children:q?e.jsx(p,{error:q}):e.jsxs("div",{style:{height:"100%"},className:"flex-row-normal-normal-medium",children:[e.jsxs("div",{style:{width:"100%",minHeight:"100%"},className:"flex-column-normal-normal-small",children:[M?e.jsx(s,{onClick:()=>{D.set({[m["IS-FILTER-MODAL-OPEN"]]:!0})},className:k}):null,R?e.jsx(x,{}):K&&K.pagesCount>1?e.jsx(j,{pagesCount:K.pagesCount}):null,R?e.jsx(v,{}):K&&0===K.posts.length?e.jsx(h,{option:{flexCenterCenter:!0,height:"FULL"},label:"Nothing found!"}):K&&K.posts.map((a=>e.jsx(N,{post:a,type:"preview"},a._id))),R?e.jsx(x,{}):K&&K.pagesCount>1?e.jsx(j,{pagesCount:K.pagesCount}):null]}),e.jsx("div",{ref:A,className:P?w:`${w} ${$}`,children:e.jsxs("div",{className:"main-content-container flex-column-normal-normal-small",children:[e.jsx("p",{className:F,children:"Sort by"}),e.jsx("div",{className:"flex-column-normal-normal-small",children:E.map((a=>e.jsxs("button",{onClick:()=>{return e=a.name,void i("descending"===l?.[e]?{[e]:"ascending"}:"ascending"===l?.[e]?{[e]:void 0}:{[e]:"descending"});var e},className:l?.[a.name]?`${L} ${z} flex-row-center-center-medium`:`${L} flex-row-center-center-medium`,children:[a.icon,e.jsx("p",{children:a.name}),"descending"===l?.[a.name]?e.jsx(t,{size:14}):"ascending"===l?.[a.name]?e.jsx(n,{size:14}):null]},a.name)))}),e.jsx(O,{changeSortData:U,sortData:r,sortDataName:"content"}),e.jsx(O,{changeSortData:U,sortData:r,sortDataName:"author"}),e.jsx(O,{changeSortData:U,sortData:r,sortDataName:"title"}),e.jsx(S,{getTags:e=>{b.current=e},placeholder:"Find by tags"}),e.jsxs("div",{className:`${I} flex-row-normal-normal-small`,children:[e.jsx(f,{onClick:()=>{0===y?H():D.set({page:0})},label:"Sort"}),e.jsx(f,{onClick:()=>{o({author:"",content:"",title:""}),i(void 0),D.set({page:0})},label:"Reset"})]})]})})]})})}},Symbol.toStringTag,{value:"Module"}));export{S as T,A as p};
