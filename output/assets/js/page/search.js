import{j as e,r as a,G as s,J as t,K as n,D as r,E as o,z as l}from"../react.js";import{u as i}from"./about.js";import{L as c,a as m}from"./home.js";import{b as u,u as d,U as g,_ as p,f as x,A as j,P as h,m as f,n as v,E as N,B as D}from"./admin.js";import{A as C,u as b}from"./database.js";const w="ge",S="he";function T({removeTag:a,tags:s}){return e.jsx("ul",{className:`${w} flex-row-flex-start-normal-small`,children:s.map((s=>{const t=s.replace(/\-\d*/g,"");return t.trim()?e.jsx("li",{onClick:()=>a(s),className:S,children:t},s):null}))})}const $=function(e){return e.split(/,/).map((e=>0===e.length?e:`${e}-${Math.round(9999*Math.random())}`))},y=function(e){return e.map((e=>e.trim().replace(/\-\d*/g,"")))},_=a.forwardRef((function({getTags:s,placeholder:t,value:n},r){const[o,l]=a.useState(n||[]);return a.useImperativeHandle(r,(()=>({clearTagsArray:function(){l([])}})),[]),e.jsxs(a.Fragment,{children:[e.jsx(u,{name:"tags",onInput:e=>{const a=$(e.currentTarget.value);l(a),s&&s(y(a))},placeholder:t,value:y(o).join(", ")}),e.jsx(T,{removeTag:e=>{l((a=>{const t=C.removeDuplicates(a,[e]);return s&&s(t),t}))},tags:o})]})})),F="V",I="W",L="X",k="Y",z="Z",O="__",R="a_";function A({changeSortData:a,sortData:s,sortDataName:t}){return e.jsx(u,{name:t,placeholder:`Find by ${t}...`,value:s[t],onInput:e=>a(t,e.currentTarget.value)})}const E=[{name:"Likes",icon:e.jsx(r,{size:17})},{name:"Views",icon:e.jsx(o,{size:17})},{name:"Comments",icon:e.jsx(l,{size:17})}],M=window.matchMedia("(width <= 930px)").matches;const P=Object.freeze(Object.defineProperty({__proto__:null,default:function(){i({title:"Finden",description:"Hier kannst du posts mit gegebenen sortierung optionen finden."});const[r,o]=a.useState({author:"",content:"",title:""}),[l,u]=a.useState(),C=d(),w=C.get("tag"),S=parseInt(C.get("page")||"0"),T=a.useRef(w?[w]:[]),$=a.useRef(null),y=a.useRef(),P=!M||b(g["IS-FILTER-MODAL-OPEN"],$),{isPending:H,data:q,error:U,request:V}=p({deps:[`sort-${S}`],noCache:!0,request:async()=>await x.post(`/sort/${S}`,{...r,sortOption:l,tags:T.current},j)}),B=(e,a)=>{o((s=>({...s,[e]:a})))};return e.jsx(a.Fragment,{children:U?e.jsx(h,{error:U}):e.jsxs("div",{style:{height:"100%"},className:"flex-row-normal-normal-medium",children:[e.jsxs("div",{style:{width:"100%",minHeight:"100%"},className:"flex-column-normal-normal-small",children:[M?e.jsx(s,{onClick:()=>{C.set({[g["IS-FILTER-MODAL-OPEN"]]:!0})},className:L}):null,H?e.jsx(f,{}):q&&q.pagesCount>1?e.jsx(v,{pagesCount:q.pagesCount}):null,H?e.jsx(c,{}):q&&0===q.posts.length?e.jsx(N,{option:{flexCenterCenter:!0,height:"FULL"},label:"Nothing found!"}):q&&q.posts.map((a=>e.jsx(m,{post:a,type:"preview"},a._id))),H?e.jsx(f,{}):q&&q.pagesCount>1?e.jsx(v,{pagesCount:q.pagesCount}):null]}),e.jsx("div",{ref:$,className:P?F:`${F} ${I}`,children:e.jsxs("div",{className:"main-content-container flex-column-normal-normal-small",children:[e.jsx("p",{className:k,children:"Sort by"}),e.jsx("div",{className:"flex-column-normal-normal-small",children:E.map((a=>e.jsxs("button",{onClick:()=>{return e=a.name,void u("descending"===l?.[e]?{[e]:"ascending"}:"ascending"===l?.[e]?{[e]:void 0}:{[e]:"descending"});var e},className:l?.[a.name]?`${z} ${O} flex-row-center-center-medium`:`${z} flex-row-center-center-medium`,children:[a.icon,e.jsx("p",{children:a.name}),"descending"===l?.[a.name]?e.jsx(t,{size:14}):"ascending"===l?.[a.name]?e.jsx(n,{size:14}):null]},a.name)))}),e.jsx(A,{changeSortData:B,sortData:r,sortDataName:"content"}),e.jsx(A,{changeSortData:B,sortData:r,sortDataName:"author"}),e.jsx(A,{changeSortData:B,sortData:r,sortDataName:"title"}),e.jsx(_,{ref:y,getTags:e=>{T.current=e},placeholder:"Find by tags"}),e.jsxs("div",{className:`${R} flex-row-normal-normal-small`,children:[e.jsx(D,{onClick:()=>{0===S?V():C.set({page:0})},label:"Sort"}),e.jsx(D,{onClick:()=>{T.current=[],o({author:"",content:"",title:""}),u(void 0),C.set({page:0}),y.current&&y.current.clearTagsArray()},label:"Reset"})]})]})})]})})}},Symbol.toStringTag,{value:"Module"}));export{_ as T,P as p};
