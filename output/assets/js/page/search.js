import{j as a,r as e,A as s,v as t,t as n,E as o,s as r}from"../react.js";import{T as l,u as i,_ as m,f as c,c as d,b as g,d as x,E as j,e as u}from"./admin.js";import{E as p,L as h,a as f,B as D}from"./home.js";import"../__commonjsHelpers__.js";const v="u",N="v",C="w",w="x",S="z";function $({changeSortData:e,sortData:s,sortDataName:t}){return a.jsx(l,{name:t,placeholder:`Sort by ${t}...`,defaultValue:s[t],onInput:a=>e(t,a.currentTarget.value)})}const b=[{name:"Likes",icon:a.jsx(n,{size:17})},{name:"Views",icon:a.jsx(o,{size:17})},{name:"Comments",icon:a.jsx(r,{size:17})}];function z(){const n=i(),o=n.get("tag"),[r,l]=e.useState({tags:o?[o]:[],author:"",content:"",title:""}),[z,_]=e.useState(),y=parseInt(n.get("page")||"0"),{isPending:k,data:E,error:O,request:T}=m({deps:[`sort-${y}`],noCache:!0,request:async()=>await c.post(`/sort/${y}`,{...r,sortOption:z},{Authorization:`Bearer ${d.getOne("PR_TOKEN")}`})}),q=(a,e)=>{l("tags"===a?a=>({...a,tags:e.split(",")}):s=>({...s,[a]:e}))};return a.jsx(e.Fragment,{children:O?a.jsx(p,{code:O.code,message:O.message}):a.jsxs("div",{className:"flex-row-normal-normal-medium",children:[a.jsxs("div",{style:{width:"100%",height:"100%"},className:"flex-column-normal-normal-small",children:[E?a.jsx(g,{pagesCount:E.pagesCount}):a.jsx(x,{}),k?a.jsx(h,{}):E&&0===E.posts.length?a.jsx(j,{option:{flexCenterCenter:!0},label:"Nothing found!"}):E&&E.posts.map((e=>a.jsx(f,{post:e,type:"preview"},e._id))),E?a.jsx(g,{pagesCount:E.pagesCount}):a.jsx(x,{})]}),a.jsxs("div",{className:`${v} main-content-container flex-column-normal-normal-small`,children:[a.jsx("p",{className:N,children:"Sort by"}),a.jsx("div",{className:"flex-row-normal-normal-small",children:b.map((e=>a.jsxs("button",{onClick:()=>{return a=e.name,void _("descending"===z?.[a]?{[a]:"ascending"}:"ascending"===z?.[a]?{[a]:void 0}:{[a]:"descending"});var a},className:z?.[e.name]?`${C} ${w} flex-row-center-center-medium`:`${C} flex-row-center-center-medium`,children:[e.icon,a.jsx("p",{children:e.name}),"descending"===z?.[e.name]?a.jsx(s,{size:14}):"ascending"===z?.[e.name]?a.jsx(t,{size:14}):null]},e.name)))}),a.jsx($,{changeSortData:q,sortData:r,sortDataName:"content"}),a.jsx($,{changeSortData:q,sortData:r,sortDataName:"author"}),a.jsx($,{changeSortData:q,sortData:r,sortDataName:"title"}),a.jsx($,{changeSortData:q,sortData:r,sortDataName:"tags"}),a.jsx(u,{removeTag:a=>{l((e=>({...e,tags:r.tags.filter(((s,t)=>t!==e.tags.indexOf(a)))})))},tags:r.tags}),a.jsxs("div",{className:`${S} flex-row-normal-normal-small`,children:[a.jsx(D,{onClick:()=>{0===y?T():n.set({page:0})},label:"Sort"}),a.jsx(D,{onClick:()=>{l({tags:[],author:"",content:"",title:""}),_(void 0),n.set({page:0})},label:"Reset"})]})]})]})})}export{z as default};
