import{u as e,r as a,j as t,v as s,A as n,w as r,H as o,E as l,t as c}from"../react.js";import{T as i,u as m,_ as u,f as g,c as d,e as x,g as p,E as j}from"./admin.js";import{E as h,L as f,a as v,B as N}from"./home.js";import{M as T}from"./galery.js";function C(t,s){const[n,r]=e();return a.useEffect((()=>{s.current?.addEventListener("click",(e=>{e.target===e.currentTarget&&r((e=>(e.set(t,String(!e.get(t))),e)))}))}),[]),JSON.parse(n.get(t)||"false")}const y={tag_list:"ie",tag_item:"je"};function D({removeTag:e,tags:a}){return t.jsx("ul",{className:`${y.tag_list} flex-row-flex-start-normal-small`,children:a.map((a=>{const s=a.replace(/\-\d*/g,"");return s.trim()?t.jsx("li",{onClick:()=>e(a),className:y.tag_item,children:s},a):null}))})}const S={createTagArray:function(e){return e.split(/,/).map((e=>0===e.length?e:`${e}-${Math.round(9999*Math.random())}`))},removeTagKeys:function(e){return e.map((e=>e.trim().replace(/\-\d*/g,"")))}};function w({getTags:e,placeholder:s,value:n}){const[r,o]=a.useState(n||[]);return t.jsxs(a.Fragment,{children:[t.jsx(i,{name:"tags",onInput:a=>{const t=S.createTagArray(a.currentTarget.value);o(t),e(S.removeTagKeys(t))},placeholder:s,value:S.removeTagKeys(r).join(", ")}),t.jsx(D,{removeTag:a=>{o((t=>{const s=function(e,a){let t=[];for(let s=0;s<e.length;s++)e[s]!==a&&t.push(e[s]);return t}(t,a);return e(s),s}))},tags:r})]})}const $="A",E="B",_="C",b="D",O="E",L="F",F="H";function k({changeSortData:e,sortData:a,sortDataName:s}){return t.jsx(i,{name:s,placeholder:`Find by ${s}...`,value:a[s],onInput:a=>e(s,a.currentTarget.value)})}const z=[{name:"Likes",icon:t.jsx(o,{size:17})},{name:"Views",icon:t.jsx(l,{size:17})},{name:"Comments",icon:t.jsx(c,{size:17})}],A=window.matchMedia("(width <= 930px)").matches;const I=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const e=a.useRef(null),[o,l]=a.useState({author:"",content:"",title:""}),[c,i]=a.useState(),y=m(),D=y.get("tag"),S=parseInt(y.get("page")||"0"),I=a.useRef(D?[D]:[]),M=!A||C(T["IS-FILTER-MODAL-OPEN"],e),{isPending:R,data:P,error:K,request:B}=u({deps:[`sort-${S}`],noCache:!0,request:async()=>await g.post(`/sort/${S}`,{...o,sortOption:c,tags:I.current},{Authorization:`Bearer ${d.getOne("PR_TOKEN")}`})}),H=(e,a)=>{l((t=>({...t,[e]:a})))};return t.jsx(a.Fragment,{children:K?t.jsx(h,{code:K.code,message:K.message}):t.jsxs("div",{style:{height:"100%"},className:"flex-row-normal-normal-medium",children:[t.jsxs("div",{style:{width:"100%",minHeight:"100%"},className:"flex-column-normal-normal-small",children:[A?t.jsx(s,{onClick:()=>{y.set({[T["IS-FILTER-MODAL-OPEN"]]:!0})},className:_}):null,R?t.jsx(x,{}):P&&P.pagesCount>1?t.jsx(p,{pagesCount:P.pagesCount}):null,R?t.jsx(f,{}):P&&0===P.posts.length?t.jsx(j,{option:{flexCenterCenter:!0,height:"FULL"},label:"Nothing found!"}):P&&P.posts.map((e=>t.jsx(v,{post:e,type:"preview"},e._id))),R?t.jsx(x,{}):P&&P.pagesCount>1?t.jsx(p,{pagesCount:P.pagesCount}):null]}),t.jsx("div",{ref:e,className:M?$:`${$} ${E}`,children:t.jsxs("div",{className:"main-content-container flex-column-normal-normal-small",children:[t.jsx("p",{className:b,children:"Sort by"}),t.jsx("div",{className:"flex-column-normal-normal-small",children:z.map((e=>t.jsxs("button",{onClick:()=>{return a=e.name,void i("descending"===c?.[a]?{[a]:"ascending"}:"ascending"===c?.[a]?{[a]:void 0}:{[a]:"descending"});var a},className:c?.[e.name]?`${O} ${L} flex-row-center-center-medium`:`${O} flex-row-center-center-medium`,children:[e.icon,t.jsx("p",{children:e.name}),"descending"===c?.[e.name]?t.jsx(n,{size:14}):"ascending"===c?.[e.name]?t.jsx(r,{size:14}):null]},e.name)))}),t.jsx(k,{changeSortData:H,sortData:o,sortDataName:"content"}),t.jsx(k,{changeSortData:H,sortData:o,sortDataName:"author"}),t.jsx(k,{changeSortData:H,sortData:o,sortDataName:"title"}),t.jsx(w,{getTags:e=>{I.current=e},placeholder:"Find by tags"}),t.jsxs("div",{className:`${F} flex-row-normal-normal-small`,children:[t.jsx(N,{onClick:()=>{0===S?B():y.set({page:0})},label:"Sort"}),t.jsx(N,{onClick:()=>{l({author:"",content:"",title:""}),i(void 0),y.set({page:0})},label:"Reset"})]})]})})]})})}},Symbol.toStringTag,{value:"Module"}));export{w as T,I as p,C as u};
