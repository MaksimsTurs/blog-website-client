import{j as e,r as a,p as s,A as t,q as n,H as r,E as o,o as l}from"../react.js";import{T as i,u as c,_ as m,f as u,c as d,d as g,e as p,E as x}from"./admin.js";import{E as h,L as j,a as f,B as N}from"./home.js";const v={"LOGIN-MODAL":"login-modal","REGISTRATE-MODAL":"registrate-modal","IS-SIDE-MENU-OPEN":"is-side-menu-open","IS-EDIT-USER-MODAL-OPEN":"is-edit-user-modal-open","IS-FILTER-MODAL-OPEN":"is-filter-modal-open"},S={tag_list:"ac",tag_item:"bc"};function T({removeTag:a,tags:s}){return e.jsx("ul",{className:`${S.tag_list} flex-row-flex-start-normal-small`,children:s.map((s=>{const t=s.replace(/\-\d*/g,"");return t.trim()?e.jsx("li",{onClick:()=>a(s),className:S.tag_item,children:t},s):null}))})}const D={createTagArray:function(e){return e.split(/,/).map((e=>0===e.length?e:`${e}-${Math.round(9999*Math.random())}`))},removeTagKeys:function(e){return e.map((e=>e.trim().replace(/\-\d*/g,"")))}};function O({getTags:s,placeholder:t,value:n}){const[r,o]=a.useState(n||[]);return e.jsxs(a.Fragment,{children:[e.jsx(i,{name:"tags",onInput:e=>{const a=D.createTagArray(e.currentTarget.value);o(a),s(D.removeTagKeys(a))},placeholder:t,value:D.removeTagKeys(r).join(", ")}),e.jsx(T,{removeTag:e=>{o((a=>{const t=function(e,a){let s=[];for(let t=0;t<e.length;t++)e[t]!==a&&s.push(e[t]);return s}(a,e);return s(t),t}))},tags:r})]})}const E="N",y="O",C="P",I="Q",$="R",w="S",L="U";function b({changeSortData:a,sortData:s,sortDataName:t}){return e.jsx(i,{name:t,placeholder:`Find by ${t}...`,value:s[t],onInput:e=>a(t,e.currentTarget.value)})}const M=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const i=c(),S=i.get("tag"),T=a.useRef(S?[S]:[]),D=window.matchMedia("(width <= 930px)").matches,M=JSON.parse(i.get(v["IS-FILTER-MODAL-OPEN"])||D?"false":"true"),[_,A]=a.useState({author:"",content:"",title:""}),[R,P]=a.useState(),z=parseInt(i.get("page")||"0"),F=[{name:"Likes",icon:e.jsx(r,{size:17})},{name:"Views",icon:e.jsx(o,{size:17})},{name:"Comments",icon:e.jsx(l,{size:17})}],{isPending:k,data:K,error:U,request:q}=m({deps:[`sort-${z}`],noCache:!0,request:async()=>await u.post(`/sort/${z}`,{..._,sortOption:R,tags:T.current},{Authorization:`Bearer ${d.getOne("PR_TOKEN")}`})}),B=(e,a)=>{A((s=>({...s,[e]:a})))};return e.jsx(a.Fragment,{children:U?e.jsx(h,{code:U.code,message:U.message}):e.jsxs("div",{style:{height:"100%"},className:"flex-row-normal-normal-medium",children:[e.jsxs("div",{style:{width:"100%",minHeight:"100%"},className:"flex-column-normal-normal-small",children:[e.jsx(s,{className:C}),k?e.jsx(g,{}):K&&K.pagesCount>=1?e.jsx(p,{pagesCount:K.pagesCount}):null,k?e.jsx(j,{}):K&&0===K.posts.length?e.jsx(x,{option:{flexCenterCenter:!0,height:"FULL"},label:"Nothing found!"}):K&&K.posts.map((a=>e.jsx(f,{post:a,type:"preview"},a._id))),k?e.jsx(g,{}):K&&K.pagesCount>=1?e.jsx(p,{pagesCount:K.pagesCount}):null]}),e.jsx("div",{className:M?E:`${E} ${y}`,children:e.jsxs("div",{className:"main-content-container flex-column-normal-normal-small",children:[e.jsx("p",{className:I,children:"Sort by"}),e.jsx("div",{className:"flex-column-normal-normal-small",children:F.map((a=>e.jsxs("button",{onClick:()=>{return e=a.name,void P("descending"===R?.[e]?{[e]:"ascending"}:"ascending"===R?.[e]?{[e]:void 0}:{[e]:"descending"});var e},className:R?.[a.name]?`${$} ${w} flex-row-center-center-medium`:`${$} flex-row-center-center-medium`,children:[a.icon,e.jsx("p",{children:a.name}),"descending"===R?.[a.name]?e.jsx(t,{size:14}):"ascending"===R?.[a.name]?e.jsx(n,{size:14}):null]},a.name)))}),e.jsx(b,{changeSortData:B,sortData:_,sortDataName:"content"}),e.jsx(b,{changeSortData:B,sortData:_,sortDataName:"author"}),e.jsx(b,{changeSortData:B,sortData:_,sortDataName:"title"}),e.jsx(O,{getTags:e=>{T.current=e},placeholder:"Find by tags"}),e.jsxs("div",{className:`${L} flex-row-normal-normal-small`,children:[e.jsx(N,{onClick:()=>{0===z?q():i.set({page:0})},label:"Sort"}),e.jsx(N,{onClick:()=>{A({author:"",content:"",title:""}),P(void 0),i.set({page:0})},label:"Reset"})]})]})})]})})}},Symbol.toStringTag,{value:"Module"}));export{v as M,O as T,M as p};
