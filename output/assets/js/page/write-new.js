import{j as t,b as e,k as r,c as n,r as s,N as a}from"../react.js";import{o,v as i,u as c,d as l,b as d,a as f,M as m,F as u,T as j,C as x,t as h,f as p,B as g,L as v,h as D,A as b}from"./admin.js";import"./about.js";import{u as _}from"./home.js";const w=i({name:"creator",initialState:{contentDraft:o.get("content-draft","[]")},reducers:{editOrinsertContentDraft:(t,{payload:e})=>{if(0===t.contentDraft.length)return o.set("content-draft",t.contentDraft=[e]);t.contentDraft.find(((t,r)=>t._id===e._id?{_id:t._id,index:r}:void 0))?o.set("content-draft",t.contentDraft=t.contentDraft.map((t=>t._id===e._id?e:t))):o.set("content-draft",t.contentDraft=[...t.contentDraft,e])},removeContentDraft:(t,{payload:e})=>{0!==t.contentDraft.length&&o.set("content-draft",t.contentDraft=t.contentDraft.filter((t=>t._id!==e)))}}}),{editOrinsertContentDraft:y,removeContentDraft:N}=w.actions,C=w.reducer,P="k",S="l",$="n";function k(){return t.jsx("div",{className:`${P} flex-row-normal-center-medium`,children:t.jsxs("div",{className:`${S} flex-column-normal-normal-small`,children:[t.jsx("div",{className:$}),t.jsx("div",{className:$}),t.jsxs("div",{className:"flex-row-normal-normal-small",children:[t.jsx("button",{}),t.jsx("button",{}),t.jsx("button",{})]}),t.jsx("div",{style:{height:"10rem"},className:$})]})})}const A="b",H="c",M="d",O={title:{isMin:{message:"Title is to short!",value:4}}};const E=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const o=e(),i=r(),w=n((t=>t.creator)),C=s.useRef(),P=s.useRef(),S=c(),$=_(),E=l(),T=S.get("draft-id");if(!E.role(["Admin","Creator"]).permited())return t.jsx(a,{to:"/"});const F=T?w.contentDraft.find((t=>t._id===T)):void 0,{mutate:I,isMutating:R,error:U}=d("/10"),{submit:W,reset:z,register:B,formState:{errors:L}}=f(O,{title:F?.title,isHidden:F?.isHidden},(()=>{C.current?.clear(),P.current?.clear()}));return t.jsxs(s.Fragment,{children:[R&&t.jsx(m,{}),$.isAuthPending?t.jsx(k,{}):t.jsx("div",{className:`${A} flex-row-normal-center-big`,children:t.jsxs(u,{className:H,onSubmit:W((async t=>{delete t.alt,delete t.uploadImg,delete t.url,I((async function(e){const r=await D.post("/insert/post",{...t,content:P.current?.value,tags:C.current?.value},b),n=e.state||[];return i(`/post/${r._id}`),[...n||[],r]})),z()})),isPending:!1,children:[t.jsx(j,{register:B,name:"title",errors:L,placeholder:"Post title"}),t.jsx(x,{register:B,name:"isHidden",label:"Hidde post"}),t.jsx(h,{ref:C,placeholder:"Post tags",value:F?.tags}),t.jsx(p,{ref:P,defaultValue:F?.content,placeholder:"Write content body here..."}),t.jsxs("div",{className:`${M} flex-row-center-normal-medium`,children:[t.jsx(g,{type:"submit",children:"Post speichern"}),t.jsx(g,{onClick:()=>{const t=T||window.crypto.randomUUID();o(y({...F,_id:t,content:P.current?.value||""})),S.set({"draft-id":t})},children:F?"Entwurf speichern":"Als Entwurf speichern"}),T&&t.jsx(g,{onClick:()=>{o(N(T)),S.remove(["draft-id"]),z()},children:"Entwurf l√∂schen"})]}),U&&t.jsx(v,{error:U.message})]})})]})}},Symbol.toStringTag,{value:"Module"}));export{k as W,C as c,E as p};
