import{j as e,b as t,k as r,c as n,r as s,N as a}from"../react.js";import{o,v as i,u as c,d as l,b as d,a as f,M as m,F as u,T as j,C as x,t as h,f as p,B as g,L as v,h as D,A as _}from"./admin.js";import"./about.js";import{u as b}from"./home.js";const w=i({name:"creator",initialState:{contentDraft:o.get("content-draft","[]")},reducers:{editOrinsertContentDraft:(e,{payload:t})=>{if(0===e.contentDraft.length)return o.set("content-draft",e.contentDraft=[t]);e.contentDraft.find(((e,r)=>e._id===t._id?{_id:e._id,index:r}:void 0))?o.set("content-draft",e.contentDraft=e.contentDraft.map((e=>e._id===t._id?t:e))):o.set("content-draft",e.contentDraft=[...e.contentDraft,t])},removeContentDraft:(e,{payload:t})=>{0!==e.contentDraft.length&&o.set("content-draft",e.contentDraft=e.contentDraft.filter((e=>e._id!==t)))}}}),{editOrinsertContentDraft:y,removeContentDraft:N}=w.actions,C=w.reducer,P="b",S="c",$="e";function A(){return e.jsx("div",{className:`${P} flex-row-normal-center-medium`,children:e.jsxs("div",{className:`${S} flex-column-normal-normal-small`,children:[e.jsx("div",{className:$}),e.jsx("div",{className:$}),e.jsxs("div",{className:"flex-row-normal-normal-small",children:[e.jsx("button",{}),e.jsx("button",{}),e.jsx("button",{})]}),e.jsx("div",{style:{height:"10rem"},className:$})]})})}const H="c_",M="d_",O="e_",k={title:{isMin:{message:"Title is to short!",value:4}}};const E=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const o=t(),i=r(),w=n((e=>e.creator)),C=s.useRef(),P=s.useRef(),S=c(),$=b(),E=l(),T=S.get("draft-id");if(!E.role(["Admin","Creator"]).permited())return e.jsx(a,{to:"/"});const F=T?w.contentDraft.find((e=>e._id===T)):void 0,{mutate:I,isMutating:R,error:U}=d("/10"),{submit:W,reset:z,register:B,formState:{errors:L}}=f(k,{title:F?.title,isHidden:F?.isHidden},(()=>{C.current?.clear(),P.current?.clear()}));return e.jsxs(s.Fragment,{children:[R&&e.jsx(m,{}),$.isAuthPending?e.jsx(A,{}):e.jsx("div",{className:`${H} flex-row-normal-center-big`,children:e.jsxs(u,{className:M,onSubmit:W((async e=>{delete e.alt,delete e.uploadImg,delete e.url,I((async function(t){const r=await D.post("/insert/post",{...e,content:P.current?.value,tags:C.current?.value},_),n=t.state||[];return i(`/post/${r._id}`),[...n||[],r]})),z()})),isPending:!1,children:[e.jsx(j,{register:B,name:"title",errors:L,placeholder:"Post title"}),e.jsx(x,{register:B,name:"isHidden",label:"Hidde post"}),e.jsx(h,{ref:C,placeholder:"Post tags",value:F?.tags}),e.jsx(p,{ref:P,defaultValue:F?.content,placeholder:"Write content body here..."}),e.jsxs("div",{className:`${O} flex-row-center-normal-medium`,children:[e.jsx(g,{type:"submit",children:"Post speichern"}),e.jsx(g,{onClick:()=>{const e=T||window.crypto.randomUUID();o(y({...F,_id:e,content:P.current?.value||""})),S.set({"draft-id":e})},children:F?"Entwurf speichern":"Als Entwurf speichern"}),T&&e.jsx(g,{onClick:()=>{o(N(T)),S.remove(["draft-id"]),z()},children:"Entwurf l√∂schen"})]}),U&&e.jsx(v,{error:U.message})]})})]})}},Symbol.toStringTag,{value:"Module"}));export{A as W,C as c,E as p};
