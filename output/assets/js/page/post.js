import{j as e,k as s,o as t,r as a,N as n,L as o,S as r}from"../react.js";import"./about.js";import{u as m,P as i,a as c}from"./home.js";import{a as d,u,d as l,U as h,b as g,M as x,E as j,l as p,F as f,f as y,B as _,h as v,A as N,D as $,I as P,_ as b,P as w}from"./admin.js";const F="r_",S="t_";function C(){return e.jsxs("div",{className:"main-content-container flex-column-center-center-medium",children:[e.jsx("div",{className:F}),e.jsx("div",{style:{width:"6rem",height:"1rem"},className:S}),e.jsx("div",{style:{width:"4rem",height:"1rem"},className:S}),e.jsx("div",{style:{width:"12rem",height:"1rem"},className:S})]})}const D="I",A="J",z="ea",E="fa";function I({isPostHidden:o,comments:r}){const c=s(),{id:$}=t(),P=a.useRef(),[b,w]=a.useState([]),{submit:F}=d(),S=u(),C=l().role(["Admin"]).permited(),D=m();if(o&&!C)return e.jsx(n,{to:"/"});const A=parseInt(S.get(h.PAGE)||"0"),{isMutating:I,mutate:K,changeError:M}=g(`post-${$}-comments-${A}`);return e.jsxs(e.Fragment,{children:[I?e.jsx(x,{}):null,0===r.length?e.jsx(j,{option:{flexCenterCenter:!0},label:"Keinen Kommentar wurde gefunden!"}):r.map((s=>e.jsx(i,{type:"comment",post:s,setToQuote:w,isQuoted:p.includeObjectByKey(b,"_id",s._id)},s._id))),D.user&&e.jsxs(f,{onSubmit:F((()=>{const e=(r||[]).length>=10;K((async s=>{if(A+1<(s.state?.pagesCount||0))return void M({code:500,message:"Du muss auf letzte seite sein um Kommentar zu hinzufÃ¼gen!"});const t=await v.post("/insert/comment",{postID:$,content:P.current?.value,quotes:b},N);return e?(c(`/post/${$}?page=${A+1}`),{pagesCount:(A||1)+1,comments:s.state?.comments||[]}):{pagesCount:s.state?.pagesCount||0,comments:[...s.state?.comments||[],t]}})),P.current?.clear(),w([])})),isPending:I,className:z,children:[e.jsx(y,{placeholder:"Write your comment here...",ref:P}),e.jsx(_,{className:E,type:"submit",children:"Senden"})]})]})}const K={author_avatar:"D_",author_name:"E_",author_registrate_data:"F_"};function M({author:s}){const t="Admin"===s.role?"#F48023":"#1682FD",a=$.getDifference(s.createdAt).getSortDate({year:"[year] year [month] months ago!",month:"[month] month [day] days ago!",day:"[day] day [hour] hours ago!",hour:"[hour] hour [minute] minutes ago!",minute:"days [minute] minutes [second] seconds ago!",second:"[second] seconds ago!"});return e.jsxs("div",{style:{height:"fit-content",flexShrink:0},className:"flex-column-center-normal-none main-content-container",children:[e.jsx(P,{classNames:{img:K.author_avatar,svg:K.author_avatar},src:s.avatar,alt:s.name}),e.jsxs("div",{className:"flex-column-center-normal-none",children:[e.jsx(o,{to:`/user/${s._id}`,className:K.author_name,children:s.name}),e.jsxs("div",{className:"flex-row-center-center-medium",style:{color:t},children:[e.jsx(r,{size:17}),e.jsx("p",{className:K.author_role,children:s.role})]}),e.jsx("p",{className:K.author_registrate_data,children:a})]})]})}const q=a.memo(i);const H=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{id:s}=t(),a=u(),n=parseInt(a.get(h.PAGE)||"0"),o=[`post-${s}-comments-${n}`],r=[`post-${s}-comments-${+n-1<=0?0:+n-1}`],m=b({deps:[`post-${s}`],request:async()=>v.get(`/post/${s}`,N)}),i=b({deps:o,prev:r,request:async()=>await v.get(`/post/${s}/comments/${n}`)});return i.prev?.pagesCount||i.data,e.jsxs(e.Fragment,{children:[m.isMutating?e.jsx(x,{}):null,m.error?e.jsx(w,{error:m.error}):e.jsxs("div",{className:`${D} flex-row-normal-normal-medium`,children:[e.jsx("div",{className:`${A} flex-column-normal-normal-medium`,children:e.jsxs(e.Fragment,{children:[m.isPending?e.jsx(c,{}):m.data?e.jsx(q,{post:m.data,type:"post"}):e.jsx(w,{error:{code:404,message:"Post not found!"}}),e.jsx(I,{comments:i.data?.comments||[],isPostHidden:m.data?.isHidden||!1})]})}),m.isFetching?e.jsx(C,{}):m.data&&m.data?.author?e.jsx(M,{author:m.data.author}):null]})]})}},Symbol.toStringTag,{value:"Module"}));export{C as P,H as p};
