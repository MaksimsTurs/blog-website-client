import{j as e,e as t,L as s,S as a,r as n,i as r}from"../react.js";import{b as o,_ as i,f as m,d as l,M as c,e as d,g as u,E as h,F as p,T as x,D as g,u as j,c as _}from"./admin.js";import{P as f,u as v,a as y,E as N}from"./home.js";const w={author_preview_loader_avatar:"i_",loader:"j_",author_preview_loader_text:"k_"};function b(){return e.jsxs("div",{className:"main-content-container flex-column-center-center-medium",children:[e.jsx("div",{className:w.author_preview_loader_avatar}),e.jsx("div",{style:{width:"6rem",height:"1rem"},className:w.author_preview_loader_text}),e.jsx("div",{style:{width:"4rem",height:"1rem"},className:w.author_preview_loader_text}),e.jsx("div",{style:{width:"12rem",height:"1rem"},className:w.author_preview_loader_text})]})}const $={comment_form_body:"T_"};function C(){return e.jsxs(e.Fragment,{children:[e.jsx(f,{}),e.jsx(f,{})]})}function F({page:s,postID:a,isPostHidden:n}){const{submit:r}=o([]),g=v(),j=t(),_=[`post-${a}-comments-${s}`],{isMutating:f,isPending:N,isFetching:w,error:b,prev:F,data:P,mutate:D,changeError:E}=i({deps:_,prev:[`post-${a}-comments-${+s-1<=0?0:+s-1}`],request:async()=>await m.get(`/post/${a}/comments/${s}`)});return e.jsxs(e.Fragment,{children:[e.jsx(l,{removeError:()=>{E(_)},error:b}),f?e.jsx(c,{}):null,w?e.jsx(d,{}):((F||P)?.pagesCount||0)>0?e.jsx(u,{disableOn:N,pagesCount:(F||P).pagesCount||0}):null,w?e.jsx(C,{}):0===P.comments.length?e.jsx(h,{option:{flexCenterCenter:!0},label:"No comments found!"}):P.comments.map((t=>e.jsx(y,{post:t,type:"comment"},t._id))),w?e.jsx(d,{}):((F||P)?.pagesCount||0)>0?e.jsx(u,{pagesCount:(F||P).pagesCount||0}):null,g.user&&!n?e.jsx("div",{className:"flex-row-center-center-none",children:e.jsx(p,{onSubmit:r((e=>{delete e.alt,delete e.url,delete e.uploadImg;const t=(P?.comments||[]).length>=10;D({key:_,request:async n=>{if(s+1<(n.state?.pagesCount||0))return void E(n.deps,{code:500,message:"You need to be on the latest page to create comment!"});const r=await m.post("/insert/comment",{...e,postID:a},{Authorization:`Bearer ${g?.user?.token}`});return t?(j(`/post/${a}?page=${s+1}`),{pagesCount:(s||1)+1,comments:n.state?.comments||[]}):{pagesCount:n.state?.pagesCount||0,comments:[...n.state?.comments||[],r]}}})})),isPending:f,className:$.comment_form_body,buttonLabel:"Write comment",children:e.jsx(x,{placeholder:"Write your comment here..."})})}):null]})}const P={author_name:"z_",author_registrate_data:"A_"};function D({author:t}){const n="Admin"===t.role?"#F48023":"#1682FD";return e.jsxs("div",{style:{height:"fit-content",flexShrink:0},className:"flex-column-center-normal-none main-content-container",children:[e.jsx("img",{src:t.avatar,alt:t.name}),e.jsxs("div",{className:"flex-column-center-normal-none",children:[e.jsx(s,{to:`/user/${t._id}`,className:P.author_name,children:t.name}),e.jsxs("div",{className:"flex-row-center-center-medium",style:{color:n},children:[e.jsx(a,{size:17}),e.jsx("p",{className:P.author_role,children:t.role})]}),e.jsx("p",{className:P.author_registrate_data,children:g.getDifference(t.createdAt)})]})]})}const E=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{id:t}=r(),s=parseInt(j().get("page")||"0"),{data:a,isPending:o,isMutating:l,isFetching:d,error:u}=i({deps:[`post-${t}`],request:async()=>m.get(`/post/${t}`,{Authorization:`Bearer ${_.getOne("PR_TOKEN")}`})});var h;return h=a?.title,n.useEffect((()=>{h&&(document.title=h)}),[h]),e.jsxs(e.Fragment,{children:[l?e.jsx(c,{}):null,e.jsxs("div",{style:{height:"100%"},className:"flex-row-normal-normal-medium",children:[e.jsx("div",{style:{flexGrow:"1"},className:"flex-column-normal-normal-medium",children:u?e.jsx(N,{code:u.code,message:u.message}):e.jsxs(e.Fragment,{children:[o?e.jsx(f,{}):e.jsx(y,{post:a,type:"post"}),e.jsx(F,{page:s,postID:t,isPostHidden:a?.isHidden||!1})]})}),d?e.jsx(b,{}):a&&a?.author?e.jsx(D,{author:a.author}):null]})]})}},Symbol.toStringTag,{value:"Module"}));export{b as P,E as p};
