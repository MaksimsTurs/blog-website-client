import{j as e,k as s,o as t,r as a,N as n,L as o,S as r}from"../react.js";import"./about.js";import{u as m,P as i,a as c}from"./home.js";import{a as d,u,d as l,U as h,b as g,M as p,E as x,l as j,F as f,f as y,B as _,h as v,A as N,D as $,I as b,_ as P,P as C,r as w}from"./admin.js";const S="Pa",F="Ra";function A(){return e.jsxs("div",{className:"main-content-container flex-column-center-center-medium",children:[e.jsx("div",{className:S}),e.jsx("div",{style:{width:"6rem",height:"1rem"},className:F}),e.jsx("div",{style:{width:"4rem",height:"1rem"},className:F}),e.jsx("div",{style:{width:"12rem",height:"1rem"},className:F})]})}const D="_",z="a",I="Y",O="Z";function E({isPostHidden:o,comments:r}){const c=s(),{id:$}=t(),b=a.useRef(),[P,C]=a.useState([]),{submit:w}=d(),S=u(),F=l().role(["Admin"]).permited(),A=m();if(o&&!F)return e.jsx(n,{to:"/"});const D=parseInt(S.get(h.PAGE)||"0"),{isMutating:z,mutate:E,changeError:H}=g(`post-${$}-comments-${D}`);return e.jsxs(e.Fragment,{children:[z?e.jsx(p,{}):null,0===r.length?e.jsx(x,{option:{flexCenterCenter:!0},label:"Keinen Kommentar wurde gefunden!"}):r.map((s=>e.jsx(i,{type:"comment",post:s,setToQuote:C,isQuoted:j.includeObjectByKey(P,"_id",s._id)},s._id))),A.user&&e.jsxs(f,{onSubmit:w((()=>{const e=(r||[]).length>=10;E((async s=>{if(D+1<(s.state?.pagesCount||0))return void H({code:500,message:"Du muss auf letzte seite sein um Kommentar zu hinzufÃ¼gen!"});const t=await v.post("/insert/comment",{postID:$,content:b.current?.value,quotes:P},N);return e?(c(`/post/${$}?page=${D+1}`),{pagesCount:(D||1)+1,comments:s.state?.comments||[]}):{pagesCount:s.state?.pagesCount||0,comments:[...s.state?.comments||[],t]}})),b.current?.clear(),C([])})),isPending:z,className:I,children:[e.jsx(y,{placeholder:"Write your comment here...",ref:b}),e.jsx(_,{className:O,type:"submit",children:"Senden"})]})]})}const H={author_avatar:"G_",author_name:"H_",author_registrate_data:"I_"};function K({author:s}){const t="Admin"===s.role?"#F48023":"#1682FD",a=$.getDifference(s.createdAt).getSortDate({year:"[year] year [month] months ago!",month:"[month] month [day] days ago!",day:"[day] day [hour] hours ago!",hour:"[hour] hour [minute] minutes ago!",minute:"days [minute] minutes [second] seconds ago!",second:"[second] seconds ago!"});return e.jsxs("div",{style:{height:"fit-content",flexShrink:0},className:"flex-column-center-normal-none main-content-container",children:[e.jsx(b,{classNames:{img:H.author_avatar,svg:H.author_avatar},src:s.avatar,alt:s.name}),e.jsxs("div",{className:"flex-column-center-normal-none",children:[e.jsx(o,{to:`/user/${s._id}`,className:H.author_name,children:s.name}),e.jsxs("div",{className:"flex-row-center-center-medium",style:{color:t},children:[e.jsx(r,{size:17}),e.jsx("p",{className:H.author_role,children:s.role})]}),e.jsx("p",{className:H.author_registrate_data,children:a})]})]})}const M=a.memo(i);const q=Object.freeze(Object.defineProperty({__proto__:null,default:function(){const{id:s}=t(),a=u(),n=parseInt(a.get(h.PAGE)||"0"),o=[`post-${s}-comments-${n}`],r=[`post-${s}-comments-${+n-1<=0?0:+n-1}`],m=P({deps:[`post-${s}`],request:async()=>v.get(`/post/${s}`,N)}),i=P({deps:o,prev:r,request:async()=>await v.get(`/post/${s}/comments/${n}`)}),d=i.prev?.pagesCount||i.data?.pagesCount||0;return e.jsxs(e.Fragment,{children:[m.isMutating?e.jsx(p,{}):null,m.error?e.jsx(C,{error:m.error}):e.jsxs("div",{className:`${D} flex-row-normal-normal-medium`,children:[e.jsx("div",{className:`${z} flex-column-normal-normal-medium`,children:e.jsxs(e.Fragment,{children:[m.isPending?e.jsx(c,{}):m.data?e.jsx(M,{post:m.data,type:"post"}):e.jsx(C,{error:{code:404,message:"Post not found!"}}),d>2&&e.jsx(w,{pagesCount:d,disableOn:!0}),e.jsx(E,{comments:i.data?.comments||[],isPostHidden:m.data?.isHidden||!1}),d>2&&e.jsx(w,{pagesCount:d,disableOn:!0})]})}),m.isFetching?e.jsx(A,{}):m.data&&m.data?.author?e.jsx(K,{author:m.data.author}):null]})]})}},Symbol.toStringTag,{value:"Module"}));export{A as P,q as p};
